# 异步编程

## 关于单线程

在学习异步编程之前，首先得理解一个概念：JavaScript的执行环境是单线程的。单线程的意思就是一次只能完成意见任务，剩下的任务排队等通知，前面的完成之后才会执行后面的任务，依次执行。

## 关于异步编程

相信大家在此之前就接触过异步编程，最典型的一个场景就是浏览器中的事件处理：

```javascript
// 示例代码
$('#btn').on('click', function() {
	// do something
});
console.log('Hello, World!');
```

在上面这段示例代码中，就是典型的异步场景。因为当浏览器执行到这里的时候并不会执行给`click`事件分配的**回调函数**。而是等到用户触发的时候才会执行。而后面的会照常执行。

加入说这个例子不是那么明确，再来看一个例子：

```javascript
setTimeout(function() {
	console.log('Hello, World');
}, 1000);
console.log('Hello, JavaScript');
```

上面这段代码，正常情况下在浏览器中会先打印第二个`console`，而等待1s(1000毫秒)之后才会打印`setTimeout()`中的`console`。但是，即便是我们设置延时等待，这里并没有阻塞后续代码的执行。

除了这些，在前面讨论过的Ajax中，发送异步请求也是异步编程。还有常见的高阶函数：

```javascript
fn1(function(data) {
	fn2(function(data) {
		fn3(function(data) {
			// ...
		});
	});
});
```

还有发布/订阅模式等等这些都是异步场景。

## 异步编程中的一些问题

虽然在大多数情况下，我们编写的代码没有什么问题。但是这里有一些细节值得注意。

比如使用定时器实现延时任务时，setTimeout函数以及setInterval函数存在一些周期性的问题。因为不同的浏览器对这两个函数的运转周期解析的不一样。

而以回调函数的深层嵌套方式，往往容易带来代码维护的问题，而且在处理跟踪错误方便也表现的不好等等。